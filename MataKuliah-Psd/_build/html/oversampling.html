
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Oversampling &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'oversampling';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Deteksi Outlier ABOD" href="abod.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyek Sain Data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="businessUnderstanding.html">Business Understanding</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dataUnderstanding.html">Data Understanding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="explorasiData.html">Explorasi Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="dataPreprocessing.html">Data Preprocessing</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="abod.html">Deteksi Outlier ABOD</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Oversampling</a></li>


</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Foversampling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/oversampling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Oversampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Oversampling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-iris-full">Data Iris-full</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oversampling-menggunakan-smote">Oversampling Menggunakan SMOTE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impor-library-dan-koneksi-database">Impor Library dan Koneksi Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengambil-data-dari-database">Mengambil Data dari Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data-awal-sebelum-smote">Visualisasi Data Awal (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-perbandingan-hasil-smote">Visualisasi Perbandingan Hasil SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-perbandingan-distribusi-kelas">Visualisasi Perbandingan Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penerapan-smote-dan-visualisasi-perbandingan-hasil">Penerapan SMOTE dan Visualisasi Perbandingan Hasil</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-klasifikasi-dengan-svm-naive-bayes">Langkah Klasifikasi dengan SVM &amp; Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-1-import-library">Cell 1 – Import Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#siapkan-data">Siapkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-sebelum-smote">Split Data (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-svm-sebelum-smote">Klasifikasi SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes-sebelum-smote">Klasifikasi Naive Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terapkan-smote">Terapkan SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-svm-sesudah-smote">Klasifikasi SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes-sesudah-smote">Klasifikasi Naive Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buat-fungsi-ekstrak-skor">Buat Fungsi Ekstrak Skor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simpan-semua-hasil-ke-tabel">Simpan Semua Hasil ke Tabel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging-classifier">Bagging Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library">Import Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-svm-sebelum-smote">BaggingClassifier SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-naive-bayes-sebelum-smote">BaggingClassifier Naïve Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-svm-sesudah-smote">BaggingClassifier SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-naive-bayes-sesudah-smote">BaggingClassifier Naïve Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabel-perbandingan">Tabel perbandingan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">================================================================</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bank-full">Data Bank-full</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Oversampling Menggunakan SMOTE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Mengambil Data dari Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Visualisasi Data Awal (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Visualisasi Perbandingan Hasil SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Visualisasi Perbandingan Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Penerapan SMOTE dan Visualisasi Perbandingan Hasil</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Langkah Klasifikasi dengan SVM &amp; Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Siapkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Split Data (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Klasifikasi SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Klasifikasi Naive Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Terapkan SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Klasifikasi SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Klasifikasi Naive Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Buat Fungsi Ekstrak Skor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Simpan Semua Hasil ke Tabel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Bagging Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">BaggingClassifier SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">BaggingClassifier Naïve Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">BaggingClassifier SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">BaggingClassifier Naïve Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Tabel perbandingan</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="oversampling">
<h1>Oversampling<a class="headerlink" href="#oversampling" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-iris-full">
<h1>Data Iris-full<a class="headerlink" href="#data-iris-full" title="Link to this heading">#</a></h1>
<p>Berikut langkah-langkah nya</p>
<section id="oversampling-menggunakan-smote">
<h2>Oversampling Menggunakan SMOTE<a class="headerlink" href="#oversampling-menggunakan-smote" title="Link to this heading">#</a></h2>
<section id="impor-library-dan-koneksi-database">
<h3>Impor Library dan Koneksi Database<a class="headerlink" href="#impor-library-dan-koneksi-database" title="Link to this heading">#</a></h3>
<p>Pada langkah pertama ini, kita akan mengimpor semua library yang dibutuhkan untuk analisis, mulai dari koneksi database hingga visualisasi. Kredensial database dimuat secara aman dari file .env untuk menghindari menuliskannya langsung di dalam kode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>

<span class="c1"># Load environment variables</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="c1"># PostgreSQL credentials</span>
<span class="n">user_postgres</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;USER_POSTGRES&quot;</span><span class="p">)</span>
<span class="n">password_postgres</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PASS_POSTGRES&quot;</span><span class="p">)</span>
<span class="n">host_postgres</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;HOST_POSTGRES&quot;</span><span class="p">)</span>
<span class="n">port_postgres</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PORT_POSTGRES&quot;</span><span class="p">)</span>
<span class="n">db_postgres</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DB_POSTGRES&quot;</span><span class="p">)</span>

<span class="c1"># MySQL credentials</span>
<span class="n">user_mysql</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;USER_MYSQL&quot;</span><span class="p">)</span>
<span class="n">password_mysql</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PASS_MYSQL&quot;</span><span class="p">)</span>
<span class="n">host_mysql</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;HOST_MYSQL&quot;</span><span class="p">)</span>
<span class="n">port_mysql</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PORT_MYSQL&quot;</span><span class="p">)</span>
<span class="n">db_mysql</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DB_MYSQL&quot;</span><span class="p">)</span>

<span class="c1"># Connections</span>
<span class="n">postgres_conn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;postgresql+psycopg2://</span><span class="si">{</span><span class="n">user_postgres</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password_postgres</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">host_postgres</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port_postgres</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">db_postgres</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">mysql_conn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mysql+pymysql://</span><span class="si">{</span><span class="n">user_mysql</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password_mysql</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">host_mysql</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port_mysql</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">db_mysql</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">postgres_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">postgres_conn</span><span class="p">)</span>
<span class="n">mysql_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">mysql_conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mengambil-data-dari-database">
<h3>Mengambil Data dari Database<a class="headerlink" href="#mengambil-data-dari-database" title="Link to this heading">#</a></h3>
<p>Setelah koneksi berhasil dibuat, kita akan mengambil data dari tabel iris_coba pada masing-masing database (MySQL dan PostgreSQL) dan memuatnya ke dalam DataFrame pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mysql_df_iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iris_coba&quot;</span><span class="p">,</span> <span class="n">mysql_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>
<span class="n">postgres_df_iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM iris_coba&quot;</span><span class="p">,</span> <span class="n">postgres_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualisasi-data-awal-sebelum-smote">
<h3>Visualisasi Data Awal (Sebelum SMOTE)<a class="headerlink" href="#visualisasi-data-awal-sebelum-smote" title="Link to this heading">#</a></h3>
<p>Sebelum melakukan penyeimbangan, penting untuk memahami kondisi awal data. Di sini, saya akan memvisualisasikan data menggunakan PCA dan LDA untuk melihat sebaran kelasnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.discriminant_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- Gunakan dataframe dari database kamu ---</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_iris</span>   <span class="c1"># bisa juga ganti ke postgres_df_iris</span>

<span class="c1"># --- Cek nama kolom ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolom dataset:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># --- Ambil fitur dan target ---</span>
<span class="n">X_db</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_db</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>   <span class="c1"># target ada di kolom &#39;Class&#39;</span>

<span class="c1"># --- Mapping label ke angka ---</span>
<span class="n">species_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Iris-setosa&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;Iris-virginica&#39;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
<span class="n">y_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">y_db</span><span class="p">])</span>
<span class="n">target_names_db</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">species_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># --- PCA (2 dimensi) ---</span>
<span class="n">pca_db</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_r_db</span> <span class="o">=</span> <span class="n">pca_db</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_db</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_db</span><span class="p">)</span>

<span class="c1"># --- LDA (2 dimensi) ---</span>
<span class="n">lda_db</span> <span class="o">=</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_r2_db</span> <span class="o">=</span> <span class="n">lda_db</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_db</span><span class="p">,</span> <span class="n">y_numeric</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_db</span><span class="p">)</span>

<span class="c1"># === Visualisasi ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ---- Plot PCA ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span> <span class="s2">&quot;darkorange&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">target_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">target_names_db</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_numeric</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_r_db</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_r_db</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target_name</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PCA - Data dari Database</span><span class="se">\n</span><span class="s2">(Ketidakseimbangan Kelas)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>

<span class="c1"># ---- Plot LDA ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">target_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">target_names_db</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_numeric</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_r2_db</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_r2_db</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target_name</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;LDA - Data dari Database</span><span class="se">\n</span><span class="s2">(Ketidakseimbangan Kelas)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;LD1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LD2&quot;</span><span class="p">)</span>

<span class="c1"># ---- Plot distribusi kelas ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">species_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">species_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">species_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;turquoise&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribusi Kelas dalam Database&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Species&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">species_counts</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Explained variance ratio (database): </span><span class="si">{</span><span class="n">pca_db</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom dataset: Index([&#39;id&#39;, &#39;Class&#39;, &#39;sepal length&#39;, &#39;sepal width&#39;, &#39;petal length&#39;,
       &#39;petal width&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<img alt="_images/ca2772e4c25fa643fb29cd135c2e613b24349478526343312abbb343caf2a817.png" src="_images/ca2772e4c25fa643fb29cd135c2e613b24349478526343312abbb343caf2a817.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Explained variance ratio (database): [0.8962252 0.0647599]
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualisasi-perbandingan-hasil-smote">
<h3>Visualisasi Perbandingan Hasil SMOTE<a class="headerlink" href="#visualisasi-perbandingan-hasil-smote" title="Link to this heading">#</a></h3>
<p>Ini adalah langkah akhir untuk memverifikasi hasil. Kita akan membuat visualisasi perbandingan <em>side-by-side</em> menggunakan PCA untuk menunjukkan perbedaan sebaran data sebelum dan sesudah penerapan SMOTE, sekaligus membuktikan bahwa data kini telah seimbang.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ambil DataFrame dari langkah sebelumnya</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_iris</span>

<span class="c1"># Pilih HANYA kolom fitur yang relevan, buang &#39;id&#39; dan &#39;Class&#39;</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width&#39;</span><span class="p">]]</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>

<span class="c1"># Mapping label string ke angka untuk model</span>
<span class="n">species_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Iris-virginica&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">y_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">y_target</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># 1. Menerapkan SMOTE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi kelas sebelum SMOTE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_numeric</span><span class="p">))</span>

<span class="c1"># Inisialisasi SMOTE dengan random_state untuk hasil yang konsisten</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># PENYESUAIAN: Menggunakan variabel X_features dan y_numeric yang sudah disiapkan</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y_numeric</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi kelas setelah SMOTE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total sampel setelah SMOTE: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>



<span class="c1"># 2. Membuat DataFrame Baru dari Hasil SMOTE</span>

<span class="c1"># Gabungkan fitur dan target yang sudah diseimbangkan</span>
<span class="n">df_resampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># PENYESUAIAN: Mapping kembali label numerik (0,1,2) ke nama kelas (string) untuk keterbacaan</span>
<span class="c1"># Buat mapping terbalik dari species_mapping sebelumnya</span>
<span class="n">inv_species_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">species_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">df_resampled</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">inv_species_mapping</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh data sintetis yang dihasilkan SMOTE:&quot;</span><span class="p">)</span>
<span class="c1"># Tampilkan 10 baris terakhir, yang kemungkinan besar adalah data baru</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_resampled</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi kelas sebelum SMOTE:
Counter({1: 50, 2: 50, 0: 15})

Distribusi kelas setelah SMOTE:
Counter({0: 50, 1: 50, 2: 50})
Total sampel setelah SMOTE: 150

Contoh data sintetis yang dihasilkan SMOTE:
     sepal length  sepal width  petal length  petal width        Class
140      4.965308     3.197962      1.500000     0.132654  Iris-setosa
141      4.485911     3.085911      1.342956     0.200000  Iris-setosa
142      4.495833     3.095833      1.347917     0.200000  Iris-setosa
143      5.003883     3.511648      1.611648     0.592234  Iris-setosa
144      4.431093     3.031093      1.315547     0.200000  Iris-setosa
145      4.874732     3.074732      1.474732     0.150536  Iris-setosa
146      4.584123     3.000000      1.346031     0.246031  Iris-setosa
147      4.776025     3.141325      1.458675     0.141325  Iris-setosa
148      4.903474     3.103474      1.489577     0.103474  Iris-setosa
149      4.860703     3.060703      1.460703     0.178593  Iris-setosa
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualisasi-perbandingan-distribusi-kelas">
<h3>Visualisasi Perbandingan Distribusi Kelas<a class="headerlink" href="#visualisasi-perbandingan-distribusi-kelas" title="Link to this heading">#</a></h3>
<p>Untuk membuktikan bahwa proses SMOTE berhasil, pada langkah ini kita membuat visualisasi perbandingan. Diagram batang di sebelah kiri menunjukkan distribusi kelas yang tidak seimbang (sebelum), sedangkan diagram di sebelah kanan menunjukkan bahwa semua kelas kini memiliki jumlah sampel yang sama (setelah). Tabel di bawahnya merangkum hasil ini secara numerik untuk memberikan bukti yang jelas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisasi perbandingan data sebelum dan sesudah SMOTE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== VISUALISASI HASIL SMOTE ===&quot;</span><span class="p">)</span>

<span class="c1"># Buat subplot untuk perbandingan</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># PERBAIKAN: Definisikan &#39;target_names&#39; di sini agar variabel selalu tersedia.</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">,</span> <span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">,</span> <span class="s1">&#39;Iris-virginica&#39;</span><span class="p">]</span>

<span class="c1"># Plot distribusi kelas sebelum SMOTE</span>
<span class="n">before_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_numeric</span><span class="p">)</span>
<span class="n">sorted_before_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">before_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">species_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_before_items</span><span class="p">]</span>
<span class="n">before_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_before_items</span><span class="p">]</span>

<span class="n">bars1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">species_indices</span><span class="p">,</span> <span class="n">before_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;turquoise&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kelas Sebelum SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Sampel&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">species_indices</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span> <span class="c1"># Sekarang variabel ini sudah ada</span>

<span class="c1"># Tambahkan label nilai di atas bar</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars1</span><span class="p">,</span> <span class="n">before_values</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Plot distribusi kelas setelah SMOTE</span>
<span class="n">after_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span>
<span class="n">sorted_after_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">after_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">after_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_after_items</span><span class="p">]</span>

<span class="n">bars2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">species_indices</span><span class="p">,</span> <span class="n">after_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;turquoise&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kelas Setelah SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Sampel&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Spesies&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">species_indices</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span> <span class="c1"># Sekarang variabel ini sudah ada</span>

<span class="c1"># Tambahkan label nilai di atas bar</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars2</span><span class="p">,</span> <span class="n">after_values</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Tabel perbandingan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabel Perbandingan:&quot;</span><span class="p">)</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Spesies&#39;</span><span class="p">:</span> <span class="n">target_names</span><span class="p">,</span>
    <span class="s1">&#39;Sebelum SMOTE&#39;</span><span class="p">:</span> <span class="n">before_values</span><span class="p">,</span>
    <span class="s1">&#39;Setelah SMOTE&#39;</span><span class="p">:</span> <span class="n">after_values</span><span class="p">,</span>
    <span class="s1">&#39;Sampel Sintetis Ditambahkan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">after_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">before_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_names</span><span class="p">))]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== VISUALISASI HASIL SMOTE ===
</pre></div>
</div>
<img alt="_images/ede752544d6a0f8467c682344b6c9cf0656a309a4d0bd5a28cded7c5864ba918.png" src="_images/ede752544d6a0f8467c682344b6c9cf0656a309a4d0bd5a28cded7c5864ba918.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tabel Perbandingan:
           Spesies  Sebelum SMOTE  Setelah SMOTE  Sampel Sintetis Ditambahkan
0      Iris-setosa             15             50                           35
1  Iris-versicolor             50             50                            0
2   Iris-virginica             50             50                            0
</pre></div>
</div>
</div>
</div>
</section>
<section id="penerapan-smote-dan-visualisasi-perbandingan-hasil">
<h3>Penerapan SMOTE dan Visualisasi Perbandingan Hasil<a class="headerlink" href="#penerapan-smote-dan-visualisasi-perbandingan-hasil" title="Link to this heading">#</a></h3>
<p>Ini adalah sel kode utama yang menjalankan keseluruhan proses. Pertama, kita mempersiapkan data dengan memilih hanya 4 kolom fitur yang relevan (membuang ‘id’). Kemudian, kita menerapkan SMOTE untuk menyeimbangkan jumlah sampel di setiap kelas. Terakhir, kita menggunakan PCA untuk memvisualisasikan data dalam 2D, membandingkan kondisi sebelum dan sesudah SMOTE untuk membuktikan keberhasilan proses penyeimbangan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="c1"># 1. PERBAIKAN: Persiapan Fitur dan Target yang Benar</span>

<span class="c1"># Ambil DataFrame dari langkah sebelumnya</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_iris</span>

<span class="c1"># Pilih HANYA kolom fitur yang relevan, buang &#39;id&#39; dan &#39;Class&#39;</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width&#39;</span><span class="p">]]</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>

<span class="c1"># Mapping label string ke angka untuk model</span>
<span class="n">species_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Iris-virginica&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">y_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">y_target</span><span class="p">])</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">species_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>


<span class="c1"># 2. Terapkan SMOTE</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sebelum SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_numeric</span><span class="p">))</span>

<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># Gunakan X_features (tanpa &#39;id&#39;) dan y_numeric untuk SMOTE</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">y_numeric</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi setelah SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Memberi spasi sebelum plot</span>


<span class="c1"># 3. PCA untuk visualisasi 2D</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Latih PCA pada data fitur asli</span>
<span class="n">X_pca_before</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_features</span><span class="p">)</span>
<span class="c1"># Gunakan PCA yang sama untuk mentransformasi data setelah SMOTE</span>
<span class="n">X_pca_after</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_res</span><span class="p">)</span>


<span class="c1"># 4. Visualisasi Perbandingan</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;turquoise&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]</span>

<span class="c1"># --- Plot data asli (sebelum SMOTE) ---</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">target_names</span><span class="p">)):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_numeric</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca_before</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca_before</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Asli (Sebelum SMOTE)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC1 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC2 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Plot data setelah SMOTE ---</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">target_names</span><span class="p">)):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">y_res</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca_after</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca_after</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Setelah SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC1 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC2 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi sebelum SMOTE: Counter({1: 50, 2: 50, 0: 15})
Distribusi setelah SMOTE: Counter({0: 50, 1: 50, 2: 50})
</pre></div>
</div>
<img alt="_images/d395bfd0a478625f37273a4d806237ce6ba309ca6aed5760ea24a919b58a16b3.png" src="_images/d395bfd0a478625f37273a4d806237ce6ba309ca6aed5760ea24a919b58a16b3.png" />
</div>
</div>
</section>
</section>
<section id="langkah-klasifikasi-dengan-svm-naive-bayes">
<h2>Langkah Klasifikasi dengan SVM &amp; Naive Bayes<a class="headerlink" href="#langkah-klasifikasi-dengan-svm-naive-bayes" title="Link to this heading">#</a></h2>
<section id="cell-1-import-library">
<h3>Cell 1 – Import Library<a class="headerlink" href="#cell-1-import-library" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library utama</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="c1"># Metode klasifikasi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>                   <span class="c1"># SVM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>    <span class="c1"># Naive Bayes</span>

<span class="c1"># Untuk balancing data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="siapkan-data">
<h3>Siapkan Data<a class="headerlink" href="#siapkan-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gunakan dataframe dari database (contoh dari MySQL)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_iris</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Fitur dan target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>

<span class="c1"># Mapping class string -&gt; angka</span>
<span class="n">species_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Iris-versicolor&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Iris-virginica&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">y_num</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data awal:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi kelas awal:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_num</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data awal: 115
Distribusi kelas awal: Counter({1: 50, 2: 50, 0: 15})
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-data-sebelum-smote">
<h3>Split Data (Sebelum SMOTE)<a class="headerlink" href="#split-data-sebelum-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bagi data training &amp; testing (70:30)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y_num</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_num</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data train:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data test :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data train: 80
Jumlah data test : 35
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-svm-sebelum-smote">
<h3>Klasifikasi SVM (Sebelum SMOTE)<a class="headerlink" href="#klasifikasi-svm-sebelum-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === METODE SVM ===</span>
<span class="n">svm_clf</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">svm_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">svm_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI SVM (Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI SVM (Sebelum SMOTE) ===
Confusion Matrix:
 [[ 5  0  0]
 [ 0 15  0]
 [ 0  0 15]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00         5
           1       1.00      1.00      1.00        15
           2       1.00      1.00      1.00        15

    accuracy                           1.00        35
   macro avg       1.00      1.00      1.00        35
weighted avg       1.00      1.00      1.00        35
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-naive-bayes-sebelum-smote">
<h3>Klasifikasi Naive Bayes (Sebelum SMOTE)<a class="headerlink" href="#klasifikasi-naive-bayes-sebelum-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === METODE NAIVE BAYES ===</span>
<span class="n">nb_clf</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_nb</span> <span class="o">=</span> <span class="n">nb_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI NAIVE BAYES (Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI NAIVE BAYES (Sebelum SMOTE) ===
Confusion Matrix:
 [[ 5  0  0]
 [ 0 13  2]
 [ 0  1 14]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00         5
           1       0.93      0.87      0.90        15
           2       0.88      0.93      0.90        15

    accuracy                           0.91        35
   macro avg       0.93      0.93      0.93        35
weighted avg       0.92      0.91      0.91        35
</pre></div>
</div>
</div>
</div>
</section>
<section id="terapkan-smote">
<h3>Terapkan SMOTE<a class="headerlink" href="#terapkan-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_num</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sebelum SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_num</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sesudah SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>

<span class="c1"># Split ulang data hasil SMOTE</span>
<span class="n">X_train_res</span><span class="p">,</span> <span class="n">X_test_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">,</span> <span class="n">y_test_res</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_res</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi sebelum SMOTE: Counter({1: 50, 2: 50, 0: 15})
Distribusi sesudah SMOTE: Counter({0: 50, 1: 50, 2: 50})
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-svm-sesudah-smote">
<h3>Klasifikasi SVM (Sesudah SMOTE)<a class="headerlink" href="#klasifikasi-svm-sesudah-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === METODE SVM ===</span>
<span class="n">svm_clf_res</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">svm_clf_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="n">y_pred_svm_res</span> <span class="o">=</span> <span class="n">svm_clf_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI SVM (Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI SVM (Sesudah SMOTE) ===
Confusion Matrix:
 [[15  0  0]
 [ 0 15  0]
 [ 0  0 15]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00        15
           1       1.00      1.00      1.00        15
           2       1.00      1.00      1.00        15

    accuracy                           1.00        45
   macro avg       1.00      1.00      1.00        45
weighted avg       1.00      1.00      1.00        45
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-naive-bayes-sesudah-smote">
<h3>Klasifikasi Naive Bayes (Sesudah SMOTE)<a class="headerlink" href="#klasifikasi-naive-bayes-sesudah-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === METODE NAIVE BAYES ===</span>
<span class="n">nb_clf_res</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_clf_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="n">y_pred_nb_res</span> <span class="o">=</span> <span class="n">nb_clf_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI NAIVE BAYES (Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI NAIVE BAYES (Sesudah SMOTE) ===
Confusion Matrix:
 [[15  0  0]
 [ 0 14  1]
 [ 0  3 12]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00        15
           1       0.82      0.93      0.88        15
           2       0.92      0.80      0.86        15

    accuracy                           0.91        45
   macro avg       0.92      0.91      0.91        45
weighted avg       0.92      0.91      0.91        45
</pre></div>
</div>
</div>
</div>
</section>
<section id="buat-fungsi-ekstrak-skor">
<h3>Buat Fungsi Ekstrak Skor<a class="headerlink" href="#buat-fungsi-ekstrak-skor" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_scores</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">kondisi</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;Kondisi&quot;</span><span class="p">:</span> <span class="n">kondisi</span><span class="p">,</span>
        <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s2">&quot;Precision&quot;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">),</span>
        <span class="s2">&quot;Recall&quot;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">),</span>
        <span class="s2">&quot;F1-Score&quot;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simpan-semua-hasil-ke-tabel">
<h3>Simpan Semua Hasil ke Tabel<a class="headerlink" href="#simpan-semua-hasil-ke-tabel" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># --- Sebelum SMOTE ---</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">,</span> <span class="s2">&quot;SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">,</span> <span class="s2">&quot;Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># --- Sesudah SMOTE ---</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">,</span> <span class="s2">&quot;SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">,</span> <span class="s2">&quot;Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># Buat DataFrame untuk perbandingan</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">df_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Kondisi</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SVM</td>
      <td>Sebelum SMOTE</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Naive Bayes</td>
      <td>Sebelum SMOTE</td>
      <td>0.914286</td>
      <td>0.934524</td>
      <td>0.933333</td>
      <td>0.933259</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SVM</td>
      <td>Sesudah SMOTE</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Naive Bayes</td>
      <td>Sesudah SMOTE</td>
      <td>0.911111</td>
      <td>0.915535</td>
      <td>0.911111</td>
      <td>0.910714</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="bagging-classifier">
<h2>Bagging Classifier<a class="headerlink" href="#bagging-classifier" title="Link to this heading">#</a></h2>
<section id="import-library">
<h3>Import Library<a class="headerlink" href="#import-library" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="baggingclassifier-svm-sebelum-smote">
<h3>BaggingClassifier SVM (Sebelum SMOTE)<a class="headerlink" href="#baggingclassifier-svm-sebelum-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan SVM (Sebelum SMOTE) ===</span>

<span class="c1"># Base estimator = SVM</span>
<span class="n">bagging_svm</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>  <span class="c1"># pakai SVM linear sebagai base model</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>                 <span class="c1"># jumlah model dalam ensemble</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Latih model</span>
<span class="n">bagging_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_svm</span> <span class="o">=</span> <span class="n">bagging_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (SVM, Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (SVM, Sebelum SMOTE) ===
Confusion Matrix:
 [[ 5  0  0]
 [ 0 14  1]
 [ 0  0 15]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00         5
           1       1.00      0.93      0.97        15
           2       0.94      1.00      0.97        15

    accuracy                           0.97        35
   macro avg       0.98      0.98      0.98        35
weighted avg       0.97      0.97      0.97        35
</pre></div>
</div>
</div>
</div>
</section>
<section id="baggingclassifier-naive-bayes-sebelum-smote">
<h3>BaggingClassifier Naïve Bayes (Sebelum SMOTE)<a class="headerlink" href="#baggingclassifier-naive-bayes-sebelum-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan Naive Bayes (Sebelum SMOTE) ===</span>
<span class="n">bagging_nb</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>   <span class="c1"># base model = Naive Bayes</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>          <span class="c1"># jumlah model</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Latih model dengan data train sebelum SMOTE</span>
<span class="n">bagging_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_nb</span> <span class="o">=</span> <span class="n">bagging_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sebelum SMOTE) ===
Confusion Matrix:
 [[ 5  0  0]
 [ 0 13  2]
 [ 0  1 14]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00         5
           1       0.93      0.87      0.90        15
           2       0.88      0.93      0.90        15

    accuracy                           0.91        35
   macro avg       0.93      0.93      0.93        35
weighted avg       0.92      0.91      0.91        35
</pre></div>
</div>
</div>
</div>
</section>
<section id="baggingclassifier-svm-sesudah-smote">
<h3>BaggingClassifier SVM (Sesudah SMOTE)<a class="headerlink" href="#baggingclassifier-svm-sesudah-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan SVM (Sesudah SMOTE) ===</span>

<span class="n">bagging_svm_res</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Latih model</span>
<span class="n">bagging_svm_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_svm_res</span> <span class="o">=</span> <span class="n">bagging_svm_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (SVM, Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (SVM, Sesudah SMOTE) ===
Confusion Matrix:
 [[15  0  0]
 [ 0 15  0]
 [ 0  1 14]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00        15
           1       0.94      1.00      0.97        15
           2       1.00      0.93      0.97        15

    accuracy                           0.98        45
   macro avg       0.98      0.98      0.98        45
weighted avg       0.98      0.98      0.98        45
</pre></div>
</div>
</div>
</div>
</section>
<section id="baggingclassifier-naive-bayes-sesudah-smote">
<h3>BaggingClassifier Naïve Bayes (Sesudah SMOTE)<a class="headerlink" href="#baggingclassifier-naive-bayes-sesudah-smote" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan Naive Bayes (Sesudah SMOTE) ===</span>
<span class="n">bagging_nb_res</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Latih model dengan data train sesudah SMOTE</span>
<span class="n">bagging_nb_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_nb_res</span> <span class="o">=</span> <span class="n">bagging_nb_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sesudah SMOTE) ===
Confusion Matrix:
 [[15  0  0]
 [ 0 14  1]
 [ 0  3 12]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00        15
           1       0.82      0.93      0.88        15
           2       0.92      0.80      0.86        15

    accuracy                           0.91        45
   macro avg       0.92      0.91      0.91        45
weighted avg       0.92      0.91      0.91        45
</pre></div>
</div>
</div>
</div>
</section>
<section id="tabel-perbandingan">
<h3>Tabel perbandingan<a class="headerlink" href="#tabel-perbandingan" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === TABEL PERBANDINGAN HASIL BAGGING CLASSIFIER ===</span>

<span class="c1"># Kumpulkan hasil evaluasi semua model</span>
<span class="n">bagging_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># --- Bagging Sebelum SMOTE ---</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">,</span> <span class="s2">&quot;Bagging SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">,</span> <span class="s2">&quot;Bagging Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># --- Bagging Sesudah SMOTE ---</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">,</span> <span class="s2">&quot;Bagging SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">,</span> <span class="s2">&quot;Bagging Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># Buat DataFrame hasil perbandingan</span>
<span class="n">df_bagging_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bagging_results</span><span class="p">)</span>

<span class="c1"># Tampilkan hasil tabel</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== PERBANDINGAN HASIL BAGGING CLASSIFIER ===&quot;</span><span class="p">)</span>
<span class="n">df_bagging_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== PERBANDINGAN HASIL BAGGING CLASSIFIER ===
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Kondisi</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bagging SVM</td>
      <td>Sebelum SMOTE</td>
      <td>0.971429</td>
      <td>0.979167</td>
      <td>0.977778</td>
      <td>0.977753</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bagging Naive Bayes</td>
      <td>Sebelum SMOTE</td>
      <td>0.914286</td>
      <td>0.934524</td>
      <td>0.933333</td>
      <td>0.933259</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bagging SVM</td>
      <td>Sesudah SMOTE</td>
      <td>0.977778</td>
      <td>0.979167</td>
      <td>0.977778</td>
      <td>0.977753</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bagging Naive Bayes</td>
      <td>Sesudah SMOTE</td>
      <td>0.911111</td>
      <td>0.915535</td>
      <td>0.911111</td>
      <td>0.910714</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id1">
<h3>================================================================<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-bank-full">
<h1>Data Bank-full<a class="headerlink" href="#data-bank-full" title="Link to this heading">#</a></h1>
<p>Berikut langkah-langkah nya</p>
<section id="id2">
<h2>Oversampling Menggunakan SMOTE<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Mengambil Data dari Database<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Data diambil dari MySQL (mysql_df_bank).
Kolom target adalah “y” (yes/no), kemudian diubah menjadi numerik (0 = no, 1 = yes).
Fitur kategorikal diubah menjadi numerik dengan one-hot encoding (“pd.get_dummies”).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mysql_df_bank</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM bank_full&quot;</span><span class="p">,</span> <span class="n">mysql_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>
<span class="n">postgres_df_bank</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM bank_full&quot;</span><span class="p">,</span> <span class="n">postgres_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ConnectionResetError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:789,</span> in <span class="ni">Connection._read_bytes</span><span class="nt">(self, num_bytes)</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">789</span>     <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">num_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>     <span class="k">break</span>

<span class="nn">File C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py:706,</span> in <span class="ni">SocketIO.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">706</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span> <span class="k">except</span> <span class="n">timeout</span><span class="p">:</span>

<span class="ne">ConnectionResetError</span>: [WinError 10054] An existing connection was forcibly closed by the remote host

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:1967,</span> in <span class="ni">Connection._exec_single_context</span><span class="nt">(self, dialect, context, statement, parameters)</span>
<span class="g g-Whitespace">   </span><span class="mi">1966</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">evt_handled</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1967</span>         <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">do_execute</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1968</span>             <span class="n">cursor</span><span class="p">,</span> <span class="n">str_statement</span><span class="p">,</span> <span class="n">effective_parameters</span><span class="p">,</span> <span class="n">context</span>
<span class="g g-Whitespace">   </span><span class="mi">1969</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1971</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_events</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">_has_events</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\default.py:951,</span> in <span class="ni">DefaultDialect.do_execute</span><span class="nt">(self, cursor, statement, parameters, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">950</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">951</span>     <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\cursors.py:153,</span> in <span class="ni">Cursor.execute</span><span class="nt">(self, query, args)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mogrify</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">153</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executed</span> <span class="o">=</span> <span class="n">query</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\cursors.py:322,</span> in <span class="ni">Cursor._query</span><span class="nt">(self, q)</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clear_result</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">322</span> <span class="n">conn</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_result</span><span class="p">()</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:575,</span> in <span class="ni">Connection.query</span><span class="nt">(self, sql, unbuffered)</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_command</span><span class="p">(</span><span class="n">COMMAND</span><span class="o">.</span><span class="n">COM_QUERY</span><span class="p">,</span> <span class="n">sql</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">575</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_query_result</span><span class="p">(</span><span class="n">unbuffered</span><span class="o">=</span><span class="n">unbuffered</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_rows</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:826,</span> in <span class="ni">Connection._read_query_result</span><span class="nt">(self, unbuffered)</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">826</span>     <span class="n">result</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">827</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="n">result</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1210,</span> in <span class="ni">MySQLResult.read</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1209</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1210</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_read_result_packet</span><span class="p">(</span><span class="n">first_packet</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1211</span> <span class="k">finally</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1287,</span> in <span class="ni">MySQLResult._read_result_packet</span><span class="nt">(self, first_packet)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_descriptions</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1287</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rowdata_packet</span><span class="p">()</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1334,</span> in <span class="ni">MySQLResult._read_rowdata_packet</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1333</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1334</span>     <span class="n">packet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">_read_packet</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1335</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_packet_is_eof</span><span class="p">(</span><span class="n">packet</span><span class="p">):</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:770,</span> in <span class="ni">Connection._read_packet</span><span class="nt">(self, packet_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">768</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_seq_id</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_seq_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
<span class="ne">--&gt; </span><span class="mi">770</span> <span class="n">recv_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bytes</span><span class="p">(</span><span class="n">bytes_to_read</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">771</span> <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:795,</span> in <span class="ni">Connection._read_bytes</span><span class="nt">(self, num_bytes)</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_force_close</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">795</span>     <span class="k">raise</span> <span class="n">err</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>         <span class="n">CR</span><span class="o">.</span><span class="n">CR_SERVER_LOST</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>         <span class="sa">f</span><span class="s2">&quot;Lost connection to MySQL server during query (</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span> <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="c1"># Don&#39;t convert unknown exception to MySQLError.</span>

<span class="ne">OperationalError</span>: (2013, &#39;Lost connection to MySQL server during query ([WinError 10054] An existing connection was forcibly closed by the remote host)&#39;)

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">48</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mysql_df_bank</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM bank_full&quot;</span><span class="p">,</span> <span class="n">mysql_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">postgres_df_bank</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM bank_full&quot;</span><span class="p">,</span> <span class="n">postgres_engine</span><span class="o">.</span><span class="n">connect</span><span class="p">())</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py:682,</span> in <span class="ni">read_sql</span><span class="nt">(sql, con, index_col, coerce_float, params, parse_dates, columns, chunksize, dtype_backend, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">672</span>     <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span>         <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span>         <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">679</span>         <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">681</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">682</span>     <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">683</span>         <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">684</span>         <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">685</span>         <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">686</span>         <span class="n">coerce_float</span><span class="o">=</span><span class="n">coerce_float</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span>         <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">688</span>         <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">689</span>         <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">690</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">691</span>     <span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py:1776,</span> in <span class="ni">SQLDatabase.read_query</span><span class="nt">(self, sql, index_col, coerce_float, parse_dates, params, chunksize, dtype, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1719</span> <span class="k">def</span><span class="w"> </span><span class="nf">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1720</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1721</span>     <span class="n">sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">1728</span>     <span class="n">dtype_backend</span><span class="p">:</span> <span class="n">DtypeBackend</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;numpy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;numpy&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1729</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="g g-Whitespace">   </span><span class="mi">1730</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1731</span><span class="sd">     Read SQL query into a DataFrame.</span>
<span class="g g-Whitespace">   </span><span class="mi">1732</span><span class="sd"> </span>
<span class="sd">   (...)   1774 </span>
<span class="g g-Whitespace">   </span><span class="mi">1775</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1776</span>     <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1777</span>     <span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1779</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py:1599,</span> in <span class="ni">SQLDatabase.execute</span><span class="nt">(self, sql, params)</span>
<span class="g g-Whitespace">   </span><span class="mi">1597</span> <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">params</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1598</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1599</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">exec_driver_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1600</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:1779,</span> in <span class="ni">Connection.exec_driver_sql</span><span class="nt">(self, statement, parameters, execution_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1774</span> <span class="n">execution_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution_options</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1775</span>     <span class="n">execution_options</span>
<span class="g g-Whitespace">   </span><span class="mi">1776</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1778</span> <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span>
<span class="ne">-&gt; </span><span class="mi">1779</span> <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1780</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1781</span>     <span class="n">dialect</span><span class="o">.</span><span class="n">execution_ctx_cls</span><span class="o">.</span><span class="n">_init_statement</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1782</span>     <span class="n">statement</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1783</span>     <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1784</span>     <span class="n">execution_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1785</span>     <span class="n">statement</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1786</span>     <span class="n">distilled_parameters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1787</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1789</span> <span class="k">return</span> <span class="n">ret</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:1846,</span> in <span class="ni">Connection._execute_context</span><span class="nt">(self, dialect, constructor, statement, parameters, execution_options, *args, **kw)</span>
<span class="g g-Whitespace">   </span><span class="mi">1844</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_insertmany_context</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1845</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1846</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_single_context</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1847</span>         <span class="n">dialect</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span>
<span class="g g-Whitespace">   </span><span class="mi">1848</span>     <span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:1986,</span> in <span class="ni">Connection._exec_single_context</span><span class="nt">(self, dialect, context, statement, parameters)</span>
<span class="g g-Whitespace">   </span><span class="mi">1983</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">_setup_result_proxy</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1985</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1986</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_handle_dbapi_exception</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1987</span>         <span class="n">e</span><span class="p">,</span> <span class="n">str_statement</span><span class="p">,</span> <span class="n">effective_parameters</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">context</span>
<span class="g g-Whitespace">   </span><span class="mi">1988</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1990</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:2355,</span> in <span class="ni">Connection._handle_dbapi_exception</span><span class="nt">(self, e, statement, parameters, cursor, context, is_sub_exec)</span>
<span class="g g-Whitespace">   </span><span class="mi">2353</span> <span class="k">elif</span> <span class="n">should_wrap</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2354</span>     <span class="k">assert</span> <span class="n">sqlalchemy_exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">2355</span>     <span class="k">raise</span> <span class="n">sqlalchemy_exception</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">exc_info</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
<span class="g g-Whitespace">   </span><span class="mi">2356</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2357</span>     <span class="k">assert</span> <span class="n">exc_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py:1967,</span> in <span class="ni">Connection._exec_single_context</span><span class="nt">(self, dialect, context, statement, parameters)</span>
<span class="g g-Whitespace">   </span><span class="mi">1965</span>                 <span class="k">break</span>
<span class="g g-Whitespace">   </span><span class="mi">1966</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">evt_handled</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1967</span>         <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">do_execute</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1968</span>             <span class="n">cursor</span><span class="p">,</span> <span class="n">str_statement</span><span class="p">,</span> <span class="n">effective_parameters</span><span class="p">,</span> <span class="n">context</span>
<span class="g g-Whitespace">   </span><span class="mi">1969</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1971</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_events</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">_has_events</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1972</span>     <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="o">.</span><span class="n">after_cursor_execute</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1973</span>         <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1974</span>         <span class="n">cursor</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">1978</span>         <span class="n">context</span><span class="o">.</span><span class="n">executemany</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1979</span>     <span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\default.py:951,</span> in <span class="ni">DefaultDialect.do_execute</span><span class="nt">(self, cursor, statement, parameters, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">950</span> <span class="k">def</span><span class="w"> </span><span class="nf">do_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">951</span>     <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\cursors.py:153,</span> in <span class="ni">Cursor.execute</span><span class="nt">(self, query, args)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mogrify</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">153</span> <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executed</span> <span class="o">=</span> <span class="n">query</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\cursors.py:322,</span> in <span class="ni">Cursor._query</span><span class="nt">(self, q)</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span> <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_db</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clear_result</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">322</span> <span class="n">conn</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_result</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowcount</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:575,</span> in <span class="ni">Connection.query</span><span class="nt">(self, sql, unbuffered)</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span>     <span class="n">sql</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="s2">&quot;surrogateescape&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_command</span><span class="p">(</span><span class="n">COMMAND</span><span class="o">.</span><span class="n">COM_QUERY</span><span class="p">,</span> <span class="n">sql</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">575</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_query_result</span><span class="p">(</span><span class="n">unbuffered</span><span class="o">=</span><span class="n">unbuffered</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">576</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_rows</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:826,</span> in <span class="ni">Connection._read_query_result</span><span class="nt">(self, unbuffered)</span>
<span class="g g-Whitespace">    </span><span class="mi">824</span>     <span class="n">result</span><span class="o">.</span><span class="n">init_unbuffered_query</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">825</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">826</span>     <span class="n">result</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">827</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="n">result</span>
<span class="g g-Whitespace">    </span><span class="mi">828</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">server_status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1210,</span> in <span class="ni">MySQLResult.read</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1208</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_read_load_local_packet</span><span class="p">(</span><span class="n">first_packet</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1209</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1210</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_read_result_packet</span><span class="p">(</span><span class="n">first_packet</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1211</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1212</span>     <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1287,</span> in <span class="ni">MySQLResult._read_result_packet</span><span class="nt">(self, first_packet)</span>
<span class="g g-Whitespace">   </span><span class="mi">1285</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_count</span> <span class="o">=</span> <span class="n">first_packet</span><span class="o">.</span><span class="n">read_length_encoded_integer</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_descriptions</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1287</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rowdata_packet</span><span class="p">()</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:1334,</span> in <span class="ni">MySQLResult._read_rowdata_packet</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1332</span> <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">   </span><span class="mi">1333</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1334</span>     <span class="n">packet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">_read_packet</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1335</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_packet_is_eof</span><span class="p">(</span><span class="n">packet</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1336</span>         <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># release reference to kill cyclic reference.</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:770,</span> in <span class="ni">Connection._read_packet</span><span class="nt">(self, packet_type)</span>
<span class="g g-Whitespace">    </span><span class="mi">764</span>     <span class="k">raise</span> <span class="n">err</span><span class="o">.</span><span class="n">InternalError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">765</span>         <span class="s2">&quot;Packet sequence number wrong - got </span><span class="si">%d</span><span class="s2"> expected </span><span class="si">%d</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">766</span>         <span class="o">%</span> <span class="p">(</span><span class="n">packet_number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_seq_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">767</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">768</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_seq_id</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_seq_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
<span class="ne">--&gt; </span><span class="mi">770</span> <span class="n">recv_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bytes</span><span class="p">(</span><span class="n">bytes_to_read</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">771</span> <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">772</span>     <span class="n">dump_packet</span><span class="p">(</span><span class="n">recv_data</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pymysql\connections.py:795,</span> in <span class="ni">Connection._read_bytes</span><span class="nt">(self, num_bytes)</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>         <span class="k">continue</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_force_close</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">795</span>     <span class="k">raise</span> <span class="n">err</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>         <span class="n">CR</span><span class="o">.</span><span class="n">CR_SERVER_LOST</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>         <span class="sa">f</span><span class="s2">&quot;Lost connection to MySQL server during query (</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span> <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="c1"># Don&#39;t convert unknown exception to MySQLError.</span>
<span class="g g-Whitespace">    </span><span class="mi">801</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_force_close</span><span class="p">()</span>

<span class="ne">OperationalError</span>: (pymysql.err.OperationalError) (2013, &#39;Lost connection to MySQL server during query ([WinError 10054] An existing connection was forcibly closed by the remote host)&#39;)
<span class="p">[</span><span class="n">SQL</span><span class="p">:</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">bank_full</span><span class="p">]</span>
<span class="p">(</span><span class="n">Background</span> <span class="n">on</span> <span class="n">this</span> <span class="n">error</span> <span class="n">at</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sqlalche</span><span class="o">.</span><span class="n">me</span><span class="o">/</span><span class="n">e</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="n">e3q8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Visualisasi Data Awal (Sebelum SMOTE)<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Distribusi kelas pada dataset “bank_full” tidak seimbang (mayoritas “no”, minoritas “yes”).
Untuk mengatasi ini digunakan SMOTE yang menghasilkan data sintetis pada kelas minoritas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.discriminant_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># --- Gunakan dataframe dari database kamu ---</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_bank</span>   <span class="c1"># atau postgres_df_bank</span>

<span class="c1"># --- Cek nama kolom ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolom dataset:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># --- Pisahkan fitur dan target ---</span>
<span class="n">X_db</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>   <span class="c1"># semua kolom kecuali target</span>
<span class="n">y_db</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>                  <span class="c1"># target yes/no</span>

<span class="c1"># --- Encoding fitur kategorikal ---</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">X_db</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_encoded</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>

<span class="c1"># --- Ubah target ke angka ---</span>
<span class="n">y_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_db</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">target_names_db</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">]</span>

<span class="c1"># --- PCA (2 dimensi) ---</span>
<span class="n">pca_db</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_r_db</span> <span class="o">=</span> <span class="n">pca_db</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span>

<span class="c1"># --- LDA (2 dimensi) ---</span>
<span class="n">lda_db</span> <span class="o">=</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># binary target → cuma 1 komponen</span>
<span class="n">X_r2_db</span> <span class="o">=</span> <span class="n">lda_db</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y_numeric</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span>

<span class="c1"># === Visualisasi ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># ---- Plot PCA ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_r_db</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_r_db</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">c</span><span class="o">=</span><span class="n">y_numeric</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PCA - Data bank_full</span><span class="se">\n</span><span class="s2">(Ketidakseimbangan Kelas)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">)</span>

<span class="c1"># ---- Plot LDA ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_r2_db</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X_r2_db</span><span class="p">),</span>
            <span class="n">c</span><span class="o">=</span><span class="n">y_numeric</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;LDA - Data bank_full</span><span class="se">\n</span><span class="s2">(Ketidakseimbangan Kelas)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;LD1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># ---- Plot distribusi kelas ----</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">class_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">class_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">class_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribusi Kelas dalam bank_full&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;y (target)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Jumlah Data&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_counts</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="mi">100</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Explained variance ratio (database, PCA): </span><span class="si">{</span><span class="n">pca_db</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom dataset: Index([&#39;id&#39;, &#39;age&#39;, &#39;job&#39;, &#39;marital&#39;, &#39;education&#39;, &#39;default&#39;, &#39;balance&#39;,
       &#39;housing&#39;, &#39;loan&#39;, &#39;contact&#39;, &#39;day&#39;, &#39;month&#39;, &#39;duration&#39;, &#39;campaign&#39;,
       &#39;pdays&#39;, &#39;previous&#39;, &#39;poutcome&#39;, &#39;y&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<img alt="_images/274a88730bc07f48df1f1805fb9b8509900bf8973a3e5247c6d9d4e2682d7c8e.png" src="_images/274a88730bc07f48df1f1805fb9b8509900bf8973a3e5247c6d9d4e2682d7c8e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Explained variance ratio (database, PCA): [0.94828743 0.05129744]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Visualisasi Perbandingan Hasil SMOTE<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Data hasil one-hot encoding memiliki banyak fitur.
Untuk memudahkan visualisasi, digunakan PCA (Principal Component Analysis) menjadi 2 dimensi.
Hasil visualisasi ditampilkan untuk kondisi sebelum SMOTE dan sesudah SMOTE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ambil DataFrame dari langkah sebelumnya</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_bank</span>   <span class="c1"># atau postgres_df_bank</span>

<span class="c1"># Pilih semua kolom fitur kecuali target &#39;y&#39;</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Target adalah kolom &#39;y&#39;</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

<span class="c1"># Encoding fitur kategorikal (karena banyak kolom object/string)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">X_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_encoded</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>

<span class="c1"># Mapping target &#39;yes&#39;/&#39;no&#39; ke angka</span>
<span class="n">y_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_target</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># 1. Menerapkan SMOTE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi kelas sebelum SMOTE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_numeric</span><span class="p">))</span>

<span class="c1"># Inisialisasi SMOTE</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Gunakan X_encoded (fitur numerik hasil encoding) dan y_numeric</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y_numeric</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi kelas setelah SMOTE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total sampel setelah SMOTE: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2. Membuat DataFrame Baru dari Hasil SMOTE</span>
<span class="n">df_resampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_encoded</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Tambahkan kolom target kembali (&#39;y&#39;), mapping 0 -&gt; no, 1 -&gt; yes</span>
<span class="n">df_resampled</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh data sintetis yang dihasilkan SMOTE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_resampled</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi kelas sebelum SMOTE:
Counter({0: 39922, 1: 5289})

Distribusi kelas setelah SMOTE:
Counter({0: 39922, 1: 39922})
Total sampel setelah SMOTE: 79844

Contoh data sintetis yang dihasilkan SMOTE:
          id  age  job  marital  education  default  balance  housing  loan  \
79834  22381   41    5        1          1        0      101        0     0   
79835  25907   44    7        0          1        0     3474        0     0   
79836  18475   39    6        1          1        0      -94        0     0   
79837  41488   44    9        1          1        0     1389        0     0   
79838  31304   24    0        2          2        0      -54        0     0   
79839  44748   37    4        1          2        0     1558        0     0   
79840   1753   28    0        1          1        0      183        1     0   
79841   8783   42    1        0          0        0      145        1     0   
79842  38646   39    1        0          1        0      352        1     0   
79843  31435   49    4        1          2        0     1427        1     0   

       contact  day  month  duration  campaign  pdays  previous  poutcome    y  
79834        0   22      1       658         2     -1         0         3  yes  
79835        0   19      9       584         1    115         0         2  yes  
79836        0   31      5       656        12     -1         0         3  yes  
79837        0    8     11       317         1     41         0         2  yes  
79838        0   10      7        93         3     -1         0         3  yes  
79839        0    8     11       315         2    216         2         2  yes  
79840        2    9      8       601         1     -1         0         3  yes  
79841        2    3      6      2500         2     -1         0         3  yes  
79842        0   16      8       955         3     -1         0         3  yes  
79843        0   29      7       287         2     -1         0         3  yes  
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>Visualisasi Perbandingan Distribusi Kelas<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisasi perbandingan data sebelum dan sesudah SMOTE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== VISUALISASI HASIL SMOTE ===&quot;</span><span class="p">)</span>

<span class="c1"># Buat subplot untuk perbandingan</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Definisikan target names untuk bank_full</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span>

<span class="c1"># --- Distribusi sebelum SMOTE ---</span>
<span class="n">before_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_numeric</span><span class="p">)</span>
<span class="n">sorted_before_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">before_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">class_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_before_items</span><span class="p">]</span>
<span class="n">before_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_before_items</span><span class="p">]</span>

<span class="n">bars1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">class_indices</span><span class="p">,</span> <span class="n">before_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kelas Sebelum SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Sampel&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">class_indices</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>

<span class="c1"># Tambahkan label nilai di atas bar</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars1</span><span class="p">,</span> <span class="n">before_values</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># --- Distribusi setelah SMOTE ---</span>
<span class="n">after_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)</span>
<span class="n">sorted_after_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">after_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="n">after_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_after_items</span><span class="p">]</span>

<span class="n">bars2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">class_indices</span><span class="p">,</span> <span class="n">after_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kelas Setelah SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Sampel&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">class_indices</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>

<span class="c1"># Tambahkan label nilai di atas bar</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars2</span><span class="p">,</span> <span class="n">after_values</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- Tabel perbandingan ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabel Perbandingan:&quot;</span><span class="p">)</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Class&#39;</span><span class="p">:</span> <span class="n">target_names</span><span class="p">,</span>
    <span class="s1">&#39;Sebelum SMOTE&#39;</span><span class="p">:</span> <span class="n">before_values</span><span class="p">,</span>
    <span class="s1">&#39;Setelah SMOTE&#39;</span><span class="p">:</span> <span class="n">after_values</span><span class="p">,</span>
    <span class="s1">&#39;Sampel Sintetis Ditambahkan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">after_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">before_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_names</span><span class="p">))]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== VISUALISASI HASIL SMOTE ===
</pre></div>
</div>
<img alt="_images/5e92b6d864d0ff645f8b8e1ee6903d6e901f55f6e7c7615694e1e91e2ffef4c5.png" src="_images/5e92b6d864d0ff645f8b8e1ee6903d6e901f55f6e7c7615694e1e91e2ffef4c5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tabel Perbandingan:
  Class  Sebelum SMOTE  Setelah SMOTE  Sampel Sintetis Ditambahkan
0    no          39922          39922                            0
1   yes           5289          39922                        34633
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>Penerapan SMOTE dan Visualisasi Perbandingan Hasil<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># === 1. Persiapan data dari bank_full ===</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_bank</span>

<span class="c1"># Target (kolom y: yes/no)</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>  <span class="c1"># encode target ke angka</span>

<span class="c1"># Fitur → drop kolom target</span>
<span class="n">X_features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Untuk data ini, kita encode semua fitur kategorikal jadi numerik (supaya bisa SMOTE + PCA)</span>
<span class="n">X_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. SMOTE ===</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sebelum SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">))</span>

<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi setelah SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># === 3. PCA untuk visualisasi 2D ===</span>
<span class="n">pca_before</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_pca_before</span> <span class="o">=</span> <span class="n">pca_before</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">)</span>

<span class="n">pca_after</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_pca_after</span> <span class="o">=</span> <span class="n">pca_after</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_res</span><span class="p">)</span>

<span class="c1"># === 4. Visualisasi ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]</span>
<span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">]</span>

<span class="c1"># --- Data asli (sebelum SMOTE) ---</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">target_names</span><span class="p">)):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_target</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca_before</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca_before</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Asli (Sebelum SMOTE)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC1 (</span><span class="si">{</span><span class="n">pca_before</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC2 (</span><span class="si">{</span><span class="n">pca_before</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># --- Data setelah SMOTE ---</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">target_names</span><span class="p">)):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_res</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca_after</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca_after</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data Setelah SMOTE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC1 (</span><span class="si">{</span><span class="n">pca_after</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PC2 (</span><span class="si">{</span><span class="n">pca_after</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># === 5. Tabel Ringkasan ===</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Kelas&#39;</span><span class="p">:</span> <span class="n">target_names</span><span class="p">,</span>
    <span class="s1">&#39;Sebelum SMOTE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">)[</span><span class="mi">1</span><span class="p">]],</span>
    <span class="s1">&#39;Setelah SMOTE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)[</span><span class="mi">1</span><span class="p">]],</span>
    <span class="s1">&#39;Sampel Sintetis Ditambahkan&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi sebelum SMOTE: Counter({0: 39922, 1: 5289})
Distribusi setelah SMOTE: Counter({0: 39922, 1: 39922})
</pre></div>
</div>
<img alt="_images/89d808e000f40708c67cfda575061c708c103c7ece7db65d23b3822f82e7aef5.png" src="_images/89d808e000f40708c67cfda575061c708c103c7ece7db65d23b3822f82e7aef5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Kelas  Sebelum SMOTE  Setelah SMOTE  Sampel Sintetis Ditambahkan
0    No          39922          39922                            0
1   Yes           5289          39922                        34633
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id8">
<h2>Langkah Klasifikasi dengan SVM &amp; Naive Bayes<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>Siapkan Data<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># Gunakan dataframe dari database (contoh dari MySQL)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mysql_df_bank</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Fitur: semua kolom kecuali &#39;y&#39;</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Target: kolom y (yes/no) → ubah ke angka</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data awal:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi kelas awal:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data awal: 45211
Distribusi kelas awal: Counter({0: 39922, 1: 5289})
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>Split Data (Sebelum SMOTE)<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gunakan hasil encoded agar semua kolom numerik</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X_encoded</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">y_target</span>   <span class="c1"># target sudah dalam bentuk 0/1</span>

<span class="c1"># Split data (70:30 stratified)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data train sebelum sampling:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data test :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="c1"># ==== Kurangi jumlah data training (misal ambil 5000 sampel) ====</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Ubah X_train dan y_train ke DataFrame/Series agar bisa di-sample</span>
<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">y_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Ambil subset data training</span>
<span class="n">X_train_small</span> <span class="o">=</span> <span class="n">X_train_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>   <span class="c1"># ambil 5000 baris</span>
<span class="n">y_train_small</span> <span class="o">=</span> <span class="n">y_train_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_train_small</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data train setelah sampling:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_small</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data train sebelum sampling: 31647
Jumlah data test : 13564
Jumlah data train setelah sampling: 5000
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3>Klasifikasi SVM (Sebelum SMOTE)<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># === METODE SVM (Data Asli / Sebelum SMOTE) dengan dataset training lebih kecil ===</span>
<span class="n">svm_clf</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1"># max_iter ditambah supaya konvergen</span>
<span class="n">svm_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_small</span><span class="p">,</span> <span class="n">y_train_small</span><span class="p">)</span>  <span class="c1"># pakai subset kecil untuk training</span>

<span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">svm_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># evaluasi tetap di test set penuh</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI SVM (Sebelum SMOTE, Train lebih kecil) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ASUS\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sklearn\svm\_classes.py:31: FutureWarning: The default value of `dual` will change from `True` to `&#39;auto&#39;` in 1.5. Set the value of `dual` explicitly to suppress the warning.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI SVM (Sebelum SMOTE, Train lebih kecil) ===
Confusion Matrix:
 [[11735   242]
 [ 1298   289]]

Classification Report:
               precision    recall  f1-score   support

           0       0.90      0.98      0.94     11977
           1       0.54      0.18      0.27      1587

    accuracy                           0.89     13564
   macro avg       0.72      0.58      0.61     13564
weighted avg       0.86      0.89      0.86     13564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ASUS\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sklearn\svm\_base.py:1237: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3>Klasifikasi Naive Bayes (Sebelum SMOTE)<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># === METODE NAIVE BAYES (Data Asli / Sebelum SMOTE) dengan subset training kecil ===</span>
<span class="n">nb_clf</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_small</span><span class="p">,</span> <span class="n">y_train_small</span><span class="p">)</span>  <span class="c1"># pakai subset kecil untuk training</span>

<span class="n">y_pred_nb</span> <span class="o">=</span> <span class="n">nb_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># evaluasi tetap di test set penuh</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI NAIVE BAYES (Sebelum SMOTE, Train lebih kecil) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI NAIVE BAYES (Sebelum SMOTE, Train lebih kecil) ===
Confusion Matrix:
 [[11200   777]
 [  831   756]]

Classification Report:
               precision    recall  f1-score   support

           0       0.93      0.94      0.93     11977
           1       0.49      0.48      0.48      1587

    accuracy                           0.88     13564
   macro avg       0.71      0.71      0.71     13564
weighted avg       0.88      0.88      0.88     13564
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>Terapkan SMOTE<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># === SMOTE ===</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_encoded</span><span class="p">,</span> <span class="n">y_target</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sebelum SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_target</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribusi sesudah SMOTE:&quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_res</span><span class="p">))</span>

<span class="c1"># === Split ulang data hasil SMOTE (pakai 70:30) ===</span>
<span class="n">X_train_res</span><span class="p">,</span> <span class="n">X_test_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">,</span> <span class="n">y_test_res</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_res</span><span class="p">,</span> <span class="n">y_res</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_res</span>
<span class="p">)</span>

<span class="c1"># === Buat subset kecil dari hasil SMOTE untuk training cepat ===</span>
<span class="n">X_train_res_small</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">y_train_res_small</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_train_res</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data train (setelah SMOTE):&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data test  (setelah SMOTE):&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subset kecil untuk training (SMOTE):&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_res_small</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distribusi sebelum SMOTE: Counter({0: 39922, 1: 5289})
Distribusi sesudah SMOTE: Counter({0: 39922, 1: 39922})
Jumlah data train (setelah SMOTE): 55890
Jumlah data test  (setelah SMOTE): 23954
Subset kecil untuk training (SMOTE): 5000
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>Klasifikasi SVM (Sesudah SMOTE)<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># === METODE SVM (Sesudah SMOTE, pakai subset kecil biar cepat) ===</span>
<span class="n">svm_clf_res</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">svm_clf_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res_small</span><span class="p">,</span> <span class="n">y_train_res_small</span><span class="p">)</span>

<span class="n">y_pred_svm_res</span> <span class="o">=</span> <span class="n">svm_clf_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI SVM (Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ASUS\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sklearn\svm\_classes.py:31: FutureWarning: The default value of `dual` will change from `True` to `&#39;auto&#39;` in 1.5. Set the value of `dual` explicitly to suppress the warning.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI SVM (Sesudah SMOTE) ===
Confusion Matrix:
 [[ 8702  3275]
 [ 1643 10334]]

Classification Report:
               precision    recall  f1-score   support

           0       0.84      0.73      0.78     11977
           1       0.76      0.86      0.81     11977

    accuracy                           0.79     23954
   macro avg       0.80      0.79      0.79     23954
weighted avg       0.80      0.79      0.79     23954
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ASUS\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sklearn\svm\_base.py:1237: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h3>Klasifikasi Naive Bayes (Sesudah SMOTE)<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># === METODE NAIVE BAYES (Sesudah SMOTE) ===</span>
<span class="n">nb_clf_res</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb_clf_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>   <span class="c1"># bisa diganti X_train_res_small kalau mau lebih cepat</span>

<span class="n">y_pred_nb_res</span> <span class="o">=</span> <span class="n">nb_clf_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI NAIVE BAYES (Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI NAIVE BAYES (Sesudah SMOTE) ===
Confusion Matrix:
 [[ 7939  4038]
 [  569 11408]]

Classification Report:
               precision    recall  f1-score   support

           0       0.93      0.66      0.78     11977
           1       0.74      0.95      0.83     11977

    accuracy                           0.81     23954
   macro avg       0.84      0.81      0.80     23954
weighted avg       0.84      0.81      0.80     23954
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3>Buat Fungsi Ekstrak Skor<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="c1"># Fungsi untuk menyimpan hasil skor</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_scores</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">kondisi</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;Kondisi&quot;</span><span class="p">:</span> <span class="n">kondisi</span><span class="p">,</span>   <span class="c1"># &quot;Sebelum SMOTE&quot; atau &quot;Sesudah SMOTE&quot;</span>
        <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span>
        <span class="s2">&quot;Precision&quot;</span><span class="p">:</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">),</span>
        <span class="s2">&quot;Recall&quot;</span><span class="p">:</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">),</span>
        <span class="s2">&quot;F1-Score&quot;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;macro&quot;</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h3>Simpan Semua Hasil ke Tabel<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># --- Sebelum SMOTE ---</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">,</span> <span class="s2">&quot;SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_nb</span><span class="p">,</span> <span class="s2">&quot;Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># --- Sesudah SMOTE ---</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_svm_res</span><span class="p">,</span> <span class="s2">&quot;SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_nb_res</span><span class="p">,</span> <span class="s2">&quot;Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># Buat DataFrame untuk perbandingan</span>
<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Tampilkan hasil akhir</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== PERBANDINGAN HASIL KLASIFIKASI ===&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== PERBANDINGAN HASIL KLASIFIKASI ===
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Kondisi</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SVM</td>
      <td>Sebelum SMOTE</td>
      <td>0.886464</td>
      <td>0.722331</td>
      <td>0.580950</td>
      <td>0.605662</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Naive Bayes</td>
      <td>Sebelum SMOTE</td>
      <td>0.881451</td>
      <td>0.712040</td>
      <td>0.705748</td>
      <td>0.708819</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SVM</td>
      <td>Sesudah SMOTE</td>
      <td>0.794690</td>
      <td>0.800265</td>
      <td>0.794690</td>
      <td>0.793732</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Naive Bayes</td>
      <td>Sesudah SMOTE</td>
      <td>0.807673</td>
      <td>0.835847</td>
      <td>0.807673</td>
      <td>0.803553</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="id18">
<h2>Bagging Classifier<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
<section id="id19">
<h3>BaggingClassifier SVM (Sebelum SMOTE)<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan LinearSVC (Sebelum SMOTE) ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Buat model Bagging dengan LinearSVC</span>
<span class="n">bagging_svm</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>  <span class="c1"># SVM cepat</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>        <span class="c1"># kurangi jumlah model biar cepat</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>              <span class="c1"># gunakan semua core CPU</span>
<span class="p">)</span>

<span class="c1"># Latih model pada data training</span>
<span class="n">bagging_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi pada data test</span>
<span class="n">y_pred_bagging_svm</span> <span class="o">=</span> <span class="n">bagging_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Tampilkan hasil evaluasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (LinearSVC, Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (LinearSVC, Sebelum SMOTE) ===
Confusion Matrix:
 [[11787   190]
 [ 1339   248]]

Classification Report:
               precision    recall  f1-score   support

           0       0.90      0.98      0.94     11977
           1       0.57      0.16      0.24      1587

    accuracy                           0.89     13564
   macro avg       0.73      0.57      0.59     13564
weighted avg       0.86      0.89      0.86     13564
</pre></div>
</div>
</div>
</div>
</section>
<section id="id20">
<h3>BaggingClassifier Naïve Bayes (Sebelum SMOTE)<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan Naive Bayes (Sebelum SMOTE) ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Buat model Bagging dengan GaussianNB</span>
<span class="n">bagging_nb</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>  <span class="c1"># base model = Naive Bayes</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>           <span class="c1"># kurangi model biar lebih cepat (10 -&gt; 5)</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>                 <span class="c1"># paralelkan seluruh core CPU</span>
<span class="p">)</span>

<span class="c1"># Latih model dengan data train (sebelum SMOTE)</span>
<span class="n">bagging_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Prediksi data test</span>
<span class="n">y_pred_bagging_nb</span> <span class="o">=</span> <span class="n">bagging_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Tampilkan hasil evaluasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sebelum SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sebelum SMOTE) ===
Confusion Matrix:
 [[11053   924]
 [  800   787]]

Classification Report:
               precision    recall  f1-score   support

           0       0.93      0.92      0.93     11977
           1       0.46      0.50      0.48      1587

    accuracy                           0.87     13564
   macro avg       0.70      0.71      0.70     13564
weighted avg       0.88      0.87      0.87     13564
</pre></div>
</div>
</div>
</div>
</section>
<section id="id21">
<h3>BaggingClassifier SVM (Sesudah SMOTE)<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan SVM (Sesudah SMOTE) ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Gunakan LinearSVC agar lebih cepat dibanding SVC(kernel=&#39;linear&#39;)</span>
<span class="n">bagging_svm_res</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">3000</span><span class="p">),</span>  <span class="c1"># lebih cepat</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>      <span class="c1"># kurangi jumlah model agar efisien</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>            <span class="c1"># gunakan semua core CPU</span>
<span class="p">)</span>

<span class="c1"># Latih model pada data hasil SMOTE</span>
<span class="n">bagging_svm_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_svm_res</span> <span class="o">=</span> <span class="n">bagging_svm_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="c1"># Evaluasi hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (SVM, Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (SVM, Sesudah SMOTE) ===
Confusion Matrix:
 [[10567  1410]
 [ 3189  8788]]

Classification Report:
               precision    recall  f1-score   support

           0       0.77      0.88      0.82     11977
           1       0.86      0.73      0.79     11977

    accuracy                           0.81     23954
   macro avg       0.81      0.81      0.81     23954
weighted avg       0.81      0.81      0.81     23954
</pre></div>
</div>
</div>
</div>
</section>
<section id="id22">
<h3>BaggingClassifier Naïve Bayes (Sesudah SMOTE)<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === BAGGING dengan Naive Bayes (Sesudah SMOTE) ===</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Gunakan pengaturan efisien seperti pada Bagging SVM</span>
<span class="n">bagging_nb_res</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>    <span class="c1"># kurangi agar eksekusi cepat &amp; stabil</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>          <span class="c1"># manfaatkan semua core CPU</span>
<span class="p">)</span>

<span class="c1"># Latih model dengan data hasil SMOTE</span>
<span class="n">bagging_nb_res</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_res</span><span class="p">,</span> <span class="n">y_train_res</span><span class="p">)</span>

<span class="c1"># Prediksi</span>
<span class="n">y_pred_bagging_nb_res</span> <span class="o">=</span> <span class="n">bagging_nb_res</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_res</span><span class="p">)</span>

<span class="c1"># Evaluasi hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sesudah SMOTE) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== HASIL KLASIFIKASI BAGGING (Naive Bayes, Sesudah SMOTE) ===
Confusion Matrix:
 [[ 7863  4114]
 [  571 11406]]

Classification Report:
               precision    recall  f1-score   support

           0       0.93      0.66      0.77     11977
           1       0.73      0.95      0.83     11977

    accuracy                           0.80     23954
   macro avg       0.83      0.80      0.80     23954
weighted avg       0.83      0.80      0.80     23954
</pre></div>
</div>
</div>
</div>
</section>
<section id="id23">
<h3>Tabel perbandingan<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === TABEL PERBANDINGAN BAGGING CLASSIFIER ===</span>

<span class="c1"># Buat list hasil</span>
<span class="n">bagging_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># --- Bagging Sebelum SMOTE ---</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_svm</span><span class="p">,</span> <span class="s2">&quot;Bagging SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_bagging_nb</span><span class="p">,</span> <span class="s2">&quot;Bagging Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sebelum SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># --- Bagging Sesudah SMOTE ---</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_svm_res</span><span class="p">,</span> <span class="s2">&quot;Bagging SVM&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>
<span class="n">bagging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_scores</span><span class="p">(</span><span class="n">y_test_res</span><span class="p">,</span> <span class="n">y_pred_bagging_nb_res</span><span class="p">,</span> <span class="s2">&quot;Bagging Naive Bayes&quot;</span><span class="p">,</span> <span class="s2">&quot;Sesudah SMOTE&quot;</span><span class="p">))</span>

<span class="c1"># Buat DataFrame hasil perbandingan</span>
<span class="n">df_bagging_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bagging_results</span><span class="p">)</span>

<span class="c1"># Tampilkan hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== PERBANDINGAN HASIL BAGGING CLASSIFIER ===&quot;</span><span class="p">)</span>
<span class="n">df_bagging_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== PERBANDINGAN HASIL BAGGING CLASSIFIER ===
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Kondisi</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bagging SVM</td>
      <td>Sebelum SMOTE</td>
      <td>0.971429</td>
      <td>0.979167</td>
      <td>0.977778</td>
      <td>0.977753</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bagging Naive Bayes</td>
      <td>Sebelum SMOTE</td>
      <td>0.914286</td>
      <td>0.934524</td>
      <td>0.933333</td>
      <td>0.933259</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bagging SVM</td>
      <td>Sesudah SMOTE</td>
      <td>0.977778</td>
      <td>0.979167</td>
      <td>0.977778</td>
      <td>0.977753</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bagging Naive Bayes</td>
      <td>Sesudah SMOTE</td>
      <td>0.911111</td>
      <td>0.915535</td>
      <td>0.911111</td>
      <td>0.910714</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="abod.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Deteksi Outlier ABOD</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Oversampling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-iris-full">Data Iris-full</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oversampling-menggunakan-smote">Oversampling Menggunakan SMOTE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impor-library-dan-koneksi-database">Impor Library dan Koneksi Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengambil-data-dari-database">Mengambil Data dari Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data-awal-sebelum-smote">Visualisasi Data Awal (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-perbandingan-hasil-smote">Visualisasi Perbandingan Hasil SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-perbandingan-distribusi-kelas">Visualisasi Perbandingan Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penerapan-smote-dan-visualisasi-perbandingan-hasil">Penerapan SMOTE dan Visualisasi Perbandingan Hasil</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-klasifikasi-dengan-svm-naive-bayes">Langkah Klasifikasi dengan SVM &amp; Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-1-import-library">Cell 1 – Import Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#siapkan-data">Siapkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-sebelum-smote">Split Data (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-svm-sebelum-smote">Klasifikasi SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes-sebelum-smote">Klasifikasi Naive Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terapkan-smote">Terapkan SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-svm-sesudah-smote">Klasifikasi SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes-sesudah-smote">Klasifikasi Naive Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buat-fungsi-ekstrak-skor">Buat Fungsi Ekstrak Skor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simpan-semua-hasil-ke-tabel">Simpan Semua Hasil ke Tabel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bagging-classifier">Bagging Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library">Import Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-svm-sebelum-smote">BaggingClassifier SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-naive-bayes-sebelum-smote">BaggingClassifier Naïve Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-svm-sesudah-smote">BaggingClassifier SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#baggingclassifier-naive-bayes-sesudah-smote">BaggingClassifier Naïve Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabel-perbandingan">Tabel perbandingan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">================================================================</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bank-full">Data Bank-full</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Oversampling Menggunakan SMOTE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Mengambil Data dari Database</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Visualisasi Data Awal (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Visualisasi Perbandingan Hasil SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Visualisasi Perbandingan Distribusi Kelas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Penerapan SMOTE dan Visualisasi Perbandingan Hasil</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Langkah Klasifikasi dengan SVM &amp; Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Siapkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Split Data (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Klasifikasi SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Klasifikasi Naive Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Terapkan SMOTE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Klasifikasi SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Klasifikasi Naive Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Buat Fungsi Ekstrak Skor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Simpan Semua Hasil ke Tabel</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Bagging Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">BaggingClassifier SVM (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">BaggingClassifier Naïve Bayes (Sebelum SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">BaggingClassifier SVM (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">BaggingClassifier Naïve Bayes (Sesudah SMOTE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Tabel perbandingan</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
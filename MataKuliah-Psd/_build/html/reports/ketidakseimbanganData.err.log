Traceback (most recent call last):
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\jupyter_core\utils\__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\nbclient\client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\jupyter_core\utils\__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\asyncio\base_events.py", line 646, in run_until_complete
    return future.result()
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "D:\Laragon\laragon\bin\python\python-3.10\lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from sklearn.decomposition import PCA
from sklearn.discriminant_analysis import LinearDiscriminantAnalysis
import matplotlib.pyplot as plt
import numpy as np

# --- Gunakan dataframe dari database kamu ---
df = mysql_df_iris   # bisa juga ganti ke postgres_df_iris

# --- Cek nama kolom ---
print("Kolom dataset:", df.columns)

# --- Ambil fitur dan target ---
X_db = df[['sepal length', 'sepal width', 'petal length', 'petal width']].values
y_db = df['Class'].values   # target ada di kolom 'Class'

# --- Mapping label ke angka ---
species_mapping = {
    'Iris-setosa': 0,
    'Iris-versicolor': 1,
    'Iris-virginica': 2
}
y_numeric = np.array([species_mapping[s] for s in y_db])
target_names_db = list(species_mapping.keys())

# --- PCA (2 dimensi) ---
pca_db = PCA(n_components=2)
X_r_db = pca_db.fit(X_db).transform(X_db)

# --- LDA (2 dimensi) ---
lda_db = LinearDiscriminantAnalysis(n_components=2)
X_r2_db = lda_db.fit(X_db, y_numeric).transform(X_db)

# === Visualisasi ===
plt.figure(figsize=(15, 5))

# ---- Plot PCA ----
plt.subplot(1, 3, 1)
colors = ["navy", "turquoise", "darkorange"]
for color, i, target_name in zip(colors, [0, 1, 2], target_names_db):
    mask = y_numeric == i
    plt.scatter(X_r_db[mask, 0], X_r_db[mask, 1],
                color=color, alpha=0.8,
                label=f"{target_name} (n={np.sum(mask)})")
plt.legend(loc="best", shadow=False, scatterpoints=1)
plt.title("PCA - Data dari Database\n(Ketidakseimbangan Kelas)")
plt.xlabel("PC1")
plt.ylabel("PC2")

# ---- Plot LDA ----
plt.subplot(1, 3, 2)
for color, i, target_name in zip(colors, [0, 1, 2], target_names_db):
    mask = y_numeric == i
    plt.scatter(X_r2_db[mask, 0], X_r2_db[mask, 1],
                color=color, alpha=0.8,
                label=f"{target_name} (n={np.sum(mask)})")
plt.legend(loc="best", shadow=False, scatterpoints=1)
plt.title("LDA - Data dari Database\n(Ketidakseimbangan Kelas)")
plt.xlabel("LD1")
plt.ylabel("LD2")

# ---- Plot distribusi kelas ----
plt.subplot(1, 3, 3)
species_counts = df['Class'].value_counts()
plt.bar(species_counts.index, species_counts.values,
        color=['navy', 'turquoise', 'darkorange'])
plt.title("Distribusi Kelas dalam Database")
plt.xlabel("Species")
plt.ylabel("Jumlah Data")
plt.xticks(rotation=45)
for i, v in enumerate(species_counts.values):
    plt.text(i, v + 0.5, str(v), ha='center', va='bottom')

plt.tight_layout()
plt.show()

print(f"\nExplained variance ratio (database): {pca_db.explained_variance_ratio_}")

------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mModuleNotFoundError[0m                       Traceback (most recent call last)
Cell [1;32mIn[3], line 3[0m
[0;32m      1[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01msklearn[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdecomposition[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m PCA
[0;32m      2[0m [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01msklearn[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdiscriminant_analysis[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m LinearDiscriminantAnalysis
[1;32m----> 3[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mmatplotlib[39;00m[38;5;21;01m.[39;00m[38;5;21;01mpyplot[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mplt[39;00m
[0;32m      4[0m [38;5;28;01mimport[39;00m[38;5;250m [39m[38;5;21;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[38;5;21;01mnp[39;00m
[0;32m      6[0m [38;5;66;03m# --- Gunakan dataframe dari database kamu ---[39;00m

[1;31mModuleNotFoundError[0m: No module named 'matplotlib'

